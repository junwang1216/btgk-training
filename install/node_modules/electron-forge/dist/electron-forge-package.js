'use strict';

var _bluebird = require('bluebird');

var _fsExtra = require('fs-extra');

var _fsExtra2 = _interopRequireDefault(_fsExtra);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _commander = require('commander');

var _commander2 = _interopRequireDefault(_commander);

require('./util/terminate');

var _package = require('./api/package');

var _package2 = _interopRequireDefault(_package);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

(0, _bluebird.coroutine)(function* () {
  let dir = process.cwd();

  _commander2.default.version(require('../package.json').version).arguments('[cwd]').option('-a, --arch [arch]', 'Target architecture').option('-p, --platform [platform]', 'Target build platform').action(function (cwd) {
    if (!cwd) return;
    if (_path2.default.isAbsolute(cwd) && _fsExtra2.default.existsSync(cwd)) {
      dir = cwd;
    } else if (_fsExtra2.default.existsSync(_path2.default.resolve(dir, cwd))) {
      dir = _path2.default.resolve(dir, cwd);
    }
  }).parse(process.argv);

  const packageOpts = {
    dir,
    interactive: true
  };
  if (_commander2.default.arch) packageOpts.arch = _commander2.default.arch;
  if (_commander2.default.platform) packageOpts.platform = _commander2.default.platform;

  yield (0, _package2.default)(packageOpts);
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVsZWN0cm9uLWZvcmdlLXBhY2thZ2UuanMiXSwibmFtZXMiOlsiZGlyIiwicHJvY2VzcyIsImN3ZCIsInZlcnNpb24iLCJyZXF1aXJlIiwiYXJndW1lbnRzIiwib3B0aW9uIiwiYWN0aW9uIiwiaXNBYnNvbHV0ZSIsImV4aXN0c1N5bmMiLCJyZXNvbHZlIiwicGFyc2UiLCJhcmd2IiwicGFja2FnZU9wdHMiLCJpbnRlcmFjdGl2ZSIsImFyY2giLCJwbGF0Zm9ybSJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOztBQUNBOzs7Ozs7QUFFQSx5QkFBQyxhQUFZO0FBQ1gsTUFBSUEsTUFBTUMsUUFBUUMsR0FBUixFQUFWOztBQUVBLHNCQUNHQyxPQURILENBQ1dDLFFBQVEsaUJBQVIsRUFBMkJELE9BRHRDLEVBRUdFLFNBRkgsQ0FFYSxPQUZiLEVBR0dDLE1BSEgsQ0FHVSxtQkFIVixFQUcrQixxQkFIL0IsRUFJR0EsTUFKSCxDQUlVLDJCQUpWLEVBSXVDLHVCQUp2QyxFQUtHQyxNQUxILENBS1UsVUFBQ0wsR0FBRCxFQUFTO0FBQ2YsUUFBSSxDQUFDQSxHQUFMLEVBQVU7QUFDVixRQUFJLGVBQUtNLFVBQUwsQ0FBZ0JOLEdBQWhCLEtBQXdCLGtCQUFHTyxVQUFILENBQWNQLEdBQWQsQ0FBNUIsRUFBZ0Q7QUFDOUNGLFlBQU1FLEdBQU47QUFDRCxLQUZELE1BRU8sSUFBSSxrQkFBR08sVUFBSCxDQUFjLGVBQUtDLE9BQUwsQ0FBYVYsR0FBYixFQUFrQkUsR0FBbEIsQ0FBZCxDQUFKLEVBQTJDO0FBQ2hERixZQUFNLGVBQUtVLE9BQUwsQ0FBYVYsR0FBYixFQUFrQkUsR0FBbEIsQ0FBTjtBQUNEO0FBQ0YsR0FaSCxFQWFHUyxLQWJILENBYVNWLFFBQVFXLElBYmpCOztBQWVBLFFBQU1DLGNBQWM7QUFDbEJiLE9BRGtCO0FBRWxCYyxpQkFBYTtBQUZLLEdBQXBCO0FBSUEsTUFBSSxvQkFBUUMsSUFBWixFQUFrQkYsWUFBWUUsSUFBWixHQUFtQixvQkFBUUEsSUFBM0I7QUFDbEIsTUFBSSxvQkFBUUMsUUFBWixFQUFzQkgsWUFBWUcsUUFBWixHQUF1QixvQkFBUUEsUUFBL0I7O0FBRXRCLFFBQU0sdUJBQVdILFdBQVgsQ0FBTjtBQUNELENBMUJEIiwiZmlsZSI6ImVsZWN0cm9uLWZvcmdlLXBhY2thZ2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgcHJvZ3JhbSBmcm9tICdjb21tYW5kZXInO1xuXG5pbXBvcnQgJy4vdXRpbC90ZXJtaW5hdGUnO1xuaW1wb3J0IHBhY2thZ2VBUEkgZnJvbSAnLi9hcGkvcGFja2FnZSc7XG5cbihhc3luYyAoKSA9PiB7XG4gIGxldCBkaXIgPSBwcm9jZXNzLmN3ZCgpO1xuXG4gIHByb2dyYW1cbiAgICAudmVyc2lvbihyZXF1aXJlKCcuLi9wYWNrYWdlLmpzb24nKS52ZXJzaW9uKVxuICAgIC5hcmd1bWVudHMoJ1tjd2RdJylcbiAgICAub3B0aW9uKCctYSwgLS1hcmNoIFthcmNoXScsICdUYXJnZXQgYXJjaGl0ZWN0dXJlJylcbiAgICAub3B0aW9uKCctcCwgLS1wbGF0Zm9ybSBbcGxhdGZvcm1dJywgJ1RhcmdldCBidWlsZCBwbGF0Zm9ybScpXG4gICAgLmFjdGlvbigoY3dkKSA9PiB7XG4gICAgICBpZiAoIWN3ZCkgcmV0dXJuO1xuICAgICAgaWYgKHBhdGguaXNBYnNvbHV0ZShjd2QpICYmIGZzLmV4aXN0c1N5bmMoY3dkKSkge1xuICAgICAgICBkaXIgPSBjd2Q7XG4gICAgICB9IGVsc2UgaWYgKGZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKGRpciwgY3dkKSkpIHtcbiAgICAgICAgZGlyID0gcGF0aC5yZXNvbHZlKGRpciwgY3dkKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5wYXJzZShwcm9jZXNzLmFyZ3YpO1xuXG4gIGNvbnN0IHBhY2thZ2VPcHRzID0ge1xuICAgIGRpcixcbiAgICBpbnRlcmFjdGl2ZTogdHJ1ZSxcbiAgfTtcbiAgaWYgKHByb2dyYW0uYXJjaCkgcGFja2FnZU9wdHMuYXJjaCA9IHByb2dyYW0uYXJjaDtcbiAgaWYgKHByb2dyYW0ucGxhdGZvcm0pIHBhY2thZ2VPcHRzLnBsYXRmb3JtID0gcHJvZ3JhbS5wbGF0Zm9ybTtcblxuICBhd2FpdCBwYWNrYWdlQVBJKHBhY2thZ2VPcHRzKTtcbn0pKCk7XG4iXX0=